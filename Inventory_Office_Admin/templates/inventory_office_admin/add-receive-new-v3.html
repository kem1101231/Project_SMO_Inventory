{% extends 'inventory_office_admin/base.html' %}

{% load staticfiles %}
{% block content %}
        <div id="page-wrapper">

            <div style="   
                                     display:inline;
                                     float:right; 
                                     right:0; 
                                     padding-top:10px;
                                     margin-top:40px;
                                     margin-bottom:0px;
                                     padding-bottom: 0px;
                                     padding-right:20px;
                                     display:none;
                                     ">

                      <form action="" method="post">{% csrf_token %}
                           <div >
                                <button class="btn btn-success" type="button" role ="button" aria-disabled="true" id="approveButton" name="approveButton" value="{{pageData1.0.0}}" style="margin-right:6px;"  data-toggle="modal"  data-target="#editReg"><i class="icon-ok"></i> Save Delivery Information</button>
                                
                      </div>

                      </form>                  
                    
                       
                       
            </div>
            <form id="theReqData" action="" method="POST">{% csrf_token %}
            <div class="panel-body" style="
                 margin-bottom: 0px;
                 padding-left: 15px;
                 font-size: 25px;
                 padding-top: 10px;
                 padding-bottom: 0px;
                 margin-top:50px; 

                ">
                <div>
                 <span name="reqNum" id="reqNum" value="{{pageData1.0.0}}">Receive Newly Delivered Items</span>
                 
                </div>
                 
               </div>
               </form>




            <div id="page-inner" style="margin-top:0px; background-color: #ddd!important;">
             
                <hr>
                
                <div id="displayDiv">
                        <div class="col-lg-12" >
                                     <div class="panel panel-default">
                                        <div class="panel-heading">
                                            <h3 class="panel-title"> Enter the Collected Transaction-Informations</h3>
                                        </div>
                                         <div class="panel-body">
                                            <form class="form-horizontal" action="" method="POST">{% csrf_token %}

                                                <div id="descripDiv" class="form-group">
                                                        <label for="text1" class="control-label col-lg-4">Invoice Number: </label>
                                            
                                                    <div class="col-lg-8">
                                                       <input type="text" id="receiptnum"  class="form-control" autofocus>
                                                    </div>
                                                </div>
                                                <div class="form-group" style="margin-bottom:10px;">
                                                        <label for="text1" class="control-label col-lg-4">Receipt Date: </label>
                                                        
                                                    <div class="col-lg-8">
                                                         <input type="text" id="recdate"  class="form-control ui1" >
                                                    </div>
                                                    
                                                </div>

                                                <div class="form-group" style="margin-bottom:10px;">
                                                    <label for="text1" class="control-label col-lg-4">Inspection Officer: </label>
                                
                                                    <div class="col-lg-8">
                                                        <input type="text" id="insofficer" list="insOffList" class="form-control ui1" >
                                                        <datalist id="insOffList">
                                                        </datalist>
                                                    </div>
                                                </div>
                                                <div class="form-group" style="margin-bottom:10px;">
                                                    <label for="text1" class="control-label col-lg-4">Inspection Date: </label>
                                            
                                                    <div class="col-lg-8">
                                                        <input type="text" id="insdate"  class="form-control ui1" >
                                                    </div>
                                                </div>
                                                <div class="form-group" style="margin-bottom:10px;">
                                                    <label for="text1" class="control-label col-lg-4">Property Officer: </label>
                                            
                                                    <div class="col-lg-8">
                                                        <input type="text" id="receiveoff" list="recOffList"  class="form-control ui1">
                                                        <datalist id="recOffList">
                                                        </datalist>
                                                    </div>
                                                </div>
                                                <div class="form-group" style="margin-bottom:10px;">
                                                    <label for="text1" class="control-label col-lg-4">Date Accepted: </label>
                                            
                                                    <div class="col-lg-8">
                                                        <input type="text" id="deldate"  class="form-control ui1" >
                                                    </div>
                                                </div>
                                           
                                            </form>
                                        </div>
                                    </div>
                                </div>

                     <div class="col-lg-12" >
                                     <div class="panel panel-default">
                                        <div class="panel-heading">
                                            <h3 class="panel-title">Check for Delivered Item/s' Quantity </h3>
                                        </div>
                                         <div class="panel-body">
                                         <form action="" method="POST">  {% csrf_token %}                           
                                         <div class="panel-body" style="padding:0px; margin:0px;">
         <div class="form-group col-lg-12">
                    <label for="text1" class="control-label col-lg-4 text-right">P.O. Number: </label>

                    <div class="col-lg-5">
                    <div>
                          <input type="text" id="ponum_field"  class="form-control ui2">

                    </div>
                      
                    <div class="checkbox">
                                <label>
                                    <div class="checker hover"><span><input id="chck" class="uniform" type="checkbox" value="option2"></span></div> This is a Non-MSU Ordered Items
                                </label>
                     </div>


                    </div>
                    
                </div>

     </div>
     </form>


                                        </div>
                                    </div>
                                </div>  



                <div class="col-lg-4">
                    <div class="panel panel-default">
                        <div class="panel-heading">P.O. Information</div>
                        <div class="panel-body">
                            
                    <div class="col-lg-12 form-group" style="padding:0px;">
                    <label for="text1" class="control-label col-lg-5" style="padding:0px; font-weight: normal;">Supplier: </label>

                    <div class="col-lg-7" style="padding:0px;">
                    <div>
                        <span id="suppNameDisplayPO" style="font-size:15px;"></span>

                    </div>

                    </div>
                    
                </div>
                 <div class="col-lg-12 form-group" style="padding:0px;">
                    <label for="text1" class="control-label col-lg-5 " style="padding:0px; font-weight: normal;">Date Served: </label>

                    <div class="col-lg-7" style="padding:0px;">
                    <div>
                        <span id="delServedDisplay" style="font-size:15px;"></span>

                    </div>

                    </div>
                    
                </div> 
                 <div class=" col-lg-12 form-group" style="padding:0px;">
                    <label for="text1" class="control-label col-lg-5" style="padding:0px; font-weight: normal;">Delivery Term: </label>

                    <div class="col-lg-7" style="padding:0px;">
                    <div>
                        <span id="delTermDisplay" style="font-size:15px;" ></span>

                    </div>

                    </div>
                    
                </div>


                        </div>
                    </div>
                </div>
                <div class="col-lg-8" style="padding-left:0px;">
               <div class="panel panel-default">
                        <div class="panel-heading">Items to Receive</div>
                        <div class="panel-body">
                            
                             <div class="table-responsive">
                                <table id="myTable" class="table table-hover table-bordered">
                                    <thead id="tablehead">
                                        <tr>
                                            <th>Decription</th>
                                            <th class="text-center">Quantity</th>
                                            <th class="text-center">Unit</th>
                                            <th class="text-center">Unit Cost</th>
                                            <th class="text-center">Is it Complete?</th>
                                        </tr>
                                    </thead>
                                    <tbody id="table">
                                        
                                    </tbody>
                                </table>
                                
                                <button id="butn" class="btn btn-sm btn-success" role= "button" aria-disabled="true" style="visibility: hidden;"><i class="icon-plus"></i> Add Item to List</button>
                            
                            </div>

                        </div>
                    </div>
                </div>
              








                </div>

               <div class="col-lg-12" >
                                     <div class="panel panel-default">
                                         <div class="panel-body" >
                                     <div style="float:right; 
                                     right:0;">
                                         <button id="prev_btn" class="btn btn-primary" style="display:none;"> <i class="icon-arrow-left"></i> Previous Step</button> 
                                         <button id="nxt_btn" class="btn btn-primary" >Next Step <i class="icon-arrow-right"></i></button>
                                     </div>
                                            
                                        </div>
                                    </div>
                                </div>
                  
                </div>    

                </div>

<!-- ======================================================= Display UI ===================================================== -->

  <div id="detailsFrame" style="display:none;">
                     <div class="col-lg-4" >
                                     <div class="panel panel-default">
                                        <div class="panel-heading">
                                            <h3 class="panel-title">Delivery Information</h3>
                                        </div>
                                        
                                        <div class="panel-body" style="height:232px; padding-left:20px;">
                                            <div class="form-group">
                                            <div style="padding-left: 2px; width:100%;">
                                                <div class="col-lg-6 dataFont2" >
                                                    PO Reference:  
                                                </div>
                                                <div  class="col-lg-6 dataFont1">
                                                <span><a target="blank" id="poRefDisplay" href="">000-00</a></span>
                                                </div>
                                            </div> 
                                        </div>
                                        <div class="form-group">
                                            <div style="padding-left: 2px; width:100%; ">
                                                <div class="col-lg-6 dataFont2" >
                                                    Expected By:  
                                                </div>
                                                <div id="dateInspectedDisplay2" class="col-lg-6 dataFont1" >
                                                    April 27, 2017
                                                </div>
                                            </div> 
                                        </div>
                                        <div class="form-group">
                                            <div style="padding-left: 2px;  width:100%;">
                                                <div class="col-lg-6 dataFont2">
                                                    Invoice No.:  
                                                </div>
                                                <div id="invNoDisplay" class="col-lg-6 dataFont1" >
                                                   ***-***-****
                                                </div>
                                            </div> 
                                        </div> 
                                        <div class="form-group">
                                            <div style="padding-left: 2px; width:100%; ">
                                                <div class="col-lg-6 dataFont2" >
                                                     Receive Date:  
                                                </div>
                                                <div id="dateReceivedDisplay" class="col-lg-6 dataFont1" >
                                                    April 27, 2017
                                                </div>
                                            </div> 
                                        </div>
                                        
                                        <div class="form-group">
                                            <div style="padding-left: 2px; width:100%;">
                                                <div class="col-lg-6 dataFont2" >
                                                 
                                                </div>
                                                <div class="col-lg-4 dataFont1">
                                                  
                                                </div>
                                            </div> 
                                        </div>
                                        <div class="form-group">
                                            <div style="padding-left: 2px; width:100%;">
                                                <div class="col-lg-6 dataFont2" >
                                                    Assesment:  
                                                </div>
                                                <div id="asses" class="col-lg-4 dataFont1">
                                                   <label class="label label-success" id="asse">On Time</label>
                                                </div>
                                            </div> 
                                        </div>
                                       
                                      
                                        
                                           
                                        </div>
                                    </div>
                                </div>

                                <div class="col-lg-3" style="padding-left:0px;">
                                     <div class="panel panel-default">
                                        <div class="panel-heading">
                                            <h3 class="panel-title">Acceptance Summary</h3>
                                        </div>
                                        <div class="panel-body" style="height:232px; padding-left:20px;">
                                        
                                        <div class="form-group">
                                            <div style="padding-left: 2px; width:100%; ">
                                                <div class="col-lg-6 dataFont2" >
                                                    IAR No.:  
                                                </div>
                                                <div id="iarNumDisplay" class="col-lg-4 dataFont1" >
                                                    000-00
                                                </div>
                                            </div> 
                                        </div>
                                        <div class="form-group">
                                            <div style="padding-left: 2px; width:100%;">
                                                <div class="col-lg-9 dataFont2" >
                                             
                                                </div>
                                                <div  class="col-lg-3 dataFont1">
                                                 
                                                </div>
                                            </div> 
                                        </div>
                                         <div class="form-group">
                                            <div style="padding-left: 2px; width:100%;">
                                                <div class="col-lg-9 dataFont2" >
                                             
                                                </div>
                                                <div class="col-lg-3 dataFont1">
                                                 
                                                </div>
                                            </div> 
                                        </div>
                                          <div class="form-group">
                                            <div style="padding-left: 2px; width:100%;">
                                                <div class="col-lg-9 dataFont2" >
                                                    Quantity Expected:  
                                                </div>
                                                <div id="totalQuan" class="col-lg-3 dataFont1">
                                                   15
                                                </div>
                                            </div> 
                                        </div>
                                         <div class="form-group">
                                            <div style="padding-left: 2px; width:100%;">
                                                <div class="col-lg-9 dataFont2" >
                                                    Quantity Received:  
                                                </div>
                                                <div id="receiveQuan" class="col-lg-3 dataFont1">
                                                   15
                                                </div>
                                            </div> 
                                        </div>
                                        <div class="form-group" >
                                            <div style="padding-left: 2px;  width:100%; margin-bottom:12px;">
                                                <div class="col-lg-9 dataFont2" >
                                                    Quantity Missing:  
                                                </div>
                                                <div id="missingQuan" class="col-lg-3 dataFont1">
                                                    00
                                                </div>
                                            </div> 
                                        </div>

                                        
                                        </div>
                                    </div>
                                </div>
                                 <div class="col-lg-5" style="padding-left:0px;">
                                     <div class="panel panel-default">
                                        <div class="panel-heading">
                                            <h3 class="panel-title">Activity Summary</h3>
                                        </div>
                                        <div class="panel-body" style="height:232px; padding-left:20px;">
                                        
                                    
                                        
                                           <div class="form-group">
                                            <div style="padding-left: 2px;  width:100%;">
                                                <div class="col-lg-5 dataFont2">
                                                    Remarks:  
                                                </div>
                                                <div id="itemsQuan" class="col-lg-6 dataFont1" >
                                                   <label class="label label-success">Complete</label>
                                                </div>
                                            </div> 
                                        </div>
                                       
                                        <div class="form-group" >
                                            <div style="padding-left: 2px;  width:100%; margin-bottom:12px;">
                                                <div class="col-lg-5 dataFont2" >
                                                   
                                                </div>
                                                <div class="col-lg-6 dataFont1">
                                                   
                                                </div>
                                            </div> 
                                        </div> 
                                          <div class="form-group">
                                            <div style="padding-left: 2px;  width:100%;">
                                                <div class="col-lg-5 dataFont2">
                                                    Supplier:  
                                                </div>
                                                <div id="suppNameDisplay" class="col-lg-6 dataFont1" >
                                                   Star Bright Office Depot
                                                </div>
                                            </div> 
                                        </div> 
                                         
                                        <div class="form-group" >
                                            <div style="padding-left: 2px;  width:100%; margin-bottom:12px;">
                                                <div class="col-lg-5 dataFont2" >
                                                    Received By; 
                                                </div>
                                                <div class="col-lg-6 dataFont1" id="recOffDis">
                                                    Rustal Ellion
                                                </div>
                                            </div> 
                                        </div> 
                                       <div class="form-group">
                                            <div style="padding-left: 2px;  width:100%;">
                                                <div class="col-lg-5 dataFont2">
                                                     Inspected By:
                                                </div>
                                                <div class="col-lg-6 dataFont1" id="insOffDis">
                                                    Julieta  Juris
                                                </div>
                                            </div> 
                                        </div> 
                                        <div class="form-group">
                                            <div style="padding-left: 2px; width:100%; ">
                                                <div class="col-lg-5 dataFont2" >
                                                    Inspection Date:  
                                                </div>
                                                <div id="dateInspectedDisplay" class="col-lg-6 dataFont1" >
                                                    April 27, 2017
                                                </div>
                                            </div> 
                                        </div>
                                           
                                        </div>
                                    </div>
                                </div>

                               
                            <div class="col-lg-12" style="display: inline;">
                                
                                   

                                    <!--  -->
                                    
                                    <div class="panel panel-default">
                                        <div class="panel-heading">
                                            <h3 class="panel-title text-center">Items Received</h3>
                                        </div>
                                        <div class="panel-body">
                                            <div class="table-responsive">
                                            <table class="table table-striped table-bordered table-hover" id="theTable">
                                                <thead>
                                                    <tr>
                                                        <th>Desciption</th>
                                                        <th class="text-center">Quantity</th>
                                                        <th class="text-center">Unit Cost</th>
                                                        <th class="text-center"  style="width: 120px;">Incomplete Qty.</th>
                                                        <th class="text-center">Remarks</th>
                                                    </tr>
                                                </thead>
                                                <tbody id="receivedItemsList">
                                                    
                                                    
                                                </tbody>
                                            </table>
                                        </div>
                                            
                                        </div>
                                    </div>
                                
                                <!-- -->

                            </div>
            


                </div>

<!-- ================================================================================================================ -->



<!-- ============================================== Wizard Modal ===================================================  -->
      
          
                        <div class="modal fade" id="receivePop" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                                <div id="modalFrame" class="modal-dialog modal-lg">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                                            <h4 class="modal-title" id="H4">Provide the following delivery data</h4>
                                        </div>
                                        <div id="modalDisplay" class="modal-body">
                                            
                                        </div>
                                        <div class="modal-footer">
                                            <button id="prev2" type="button" class="btn btn-primary" style="visibility:hidden">Previous Step</button><button id="saveInfo" type="button" class="btn btn-primary" >Next Step</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                  
<!-- ==============================================================================================================  -->
<!-- ============================================== Wizard Modal ===================================================  -->
      
          
                        <div class="modal fade" id="jOption" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                                <div id="modalFrame" class="modal-dialog modal-sm">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                                            <h4 class="modal-title" id="joptionTitle"></h4>
                                        </div>
                                        <div  class="modal-body">
                                            <input type="text" name="inputField" id="inputField" class="form-control">
                                        </div>
                                        <div class="modal-footer">
                                            <button id="jOptionSave" type="button" class="btn btn-success">Save</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                  
<!-- ==============================================================================================================  -->
<!-- ===================================================   Modal ==================================================================================  -->
           
                       <div class="modal fade" id="transComp" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                            <div class="modal-dialog ">
                                <div class="modal-content ">
                                   
                                    
                                    <div class="modal-body ">

                                        <div class="media" role="submit" name="notif1" id="notif1" value="GGWP">
                                    
                                            <span class="pull-left" >
                                                <div class="btn btn-success btn-lg btn-circle" role="button" aria-disabled="true" disabled = "disabled">
                                                    <i class="icon-ok"></i></div>
                                    </span>  
                                    <div class="media-body">
                                        <h5 class="media-heading" style="margin-top:10px;">
                                            <strong>Items received and recorded</strong>
                                        </h5>
                                        <hr>
                                        
                                        <p style="margin-bottom:10px;">The Newly Delivered items has been recoreded</p>
                                        <p style="margin-bottom:10px;">The items are now available for PAR once the checking of documents is complete</p>  
                                    </div>
                                    

                                </div>
                                        
                                    </div>
                                        
                                    <div class="modal-footer">
                                            <button id="sentNotif" data-dismiss="modal" type="submit" class="btn btn-info">OK</button>
                                    </div>
                                </div>
                            </div>
                        </div>

<!-- ===================================================   Modal ==================================================================================  -->
<!-- ===================================================   Modal ==================================================================================  -->
           
                       <div class="modal fade" id="transComp2" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                            <div class="modal-dialog ">
                                <div class="modal-content ">
                                   
                                    
                                    <div class="modal-body ">

                                        <div class="media" role="submit" name="notif1" id="notif1" value="GGWP">
                                    
                                            <span class="pull-left" >
                                                <div class="btn btn-success btn-lg btn-circle" role="button" aria-disabled="true" disabled = "disabled">
                                                    <i class="icon-spinner"></i></div>
                                    </span>  
                                    <div class="media-body">
                                        <h5 class="media-heading" style="margin-top:10px;">
                                            <strong>Generating Report Document</strong>
                                        </h5>
                                        <hr>
                                        
                                        <p style="margin-bottom:10px;">The system is currently requesting for the document of this report</p>
                                        <p style="margin-bottom:10px;">Please do not close this modal until the dowload starts</p>
                                    </div>
                                    

                                </div>
                                        
                                    </div>
                                        
                                    <div class="modal-footer">
                                            <button id="sentNotif2" data-dismiss="modal" type="submit" class="btn btn-info">Close</button>
                                    </div>
                                </div>
                            </div>
                        </div>

<!-- ===================================================   Modal ==================================================================================  -->




            <!-- /. PAGE INNER  -->
        </div>
        <!-- /. PAGE WRAPPER  -->
    </div>
    <div id="footer-sec">
       &copy; Mindanao State University - General Santos City</i>  
    </div>

    <!-- /. FOOTER  -->
    <!-- SCRIPTS -AT THE BOTOM TO REDUCE THE LOAD TIME-->
    <!-- JQUERY SCRIPTS -->
    <script src="{% static 'assets/js/jquery-1.10.2.js' %}"></script>
    <!-- BOOTSTRAP SCRIPTS -->
    <script src="{% static 'assets/js/bootstrap.js' %}"></script>
    <!-- METISMENU SCRIPTS -->
    <script src="{% static 'assets/js/jquery.metisMenu.js' %}"></script>
    <!-- CUSTOM SCRIPTS -->
    <script src="{% static 'assets/js/custom.js' %}"></script>
     <script src="{% static 'assets/js/default-inven.js' %}"></script>
    <!-- WIZARD SCRIPTS -->
    <script src="{% static 'assets/plugins/morris/raphael-2.1.0.min.js' %}"></script>
    <script src="{% static 'assets/plugins/morris/morris.js' %}"></script>


    <script src="{% static 'assets/plugins/daterangepicker/daterangepicker.js' %}"></script>
    <script src="{% static 'assets/plugins/daterangepicker/moment.min.js' %}"></script>
    <script src="{% static 'assets/plugins/datepicker/js/bootstrap-datepicker.js' %}"></script>

       <script type="text/javascript">
        
       $(document).ready(function () {
           $('#new_items').attr('class', 'active-menu-inven theAs')
           $('#theDelUL').attr('class','nav nav-second-level collapse in theULs')
           $('#delTop').attr('class', 'active-menu-top theTopAs')
       })   



$('#idTourDateDetails').datepicker({

     dateFormat: 'dd-mm-yy',

     minDate: '+5d',

     changeMonth: true,

     changeYear: true,

     altField: "#idTourDateDetailsHidden",

     altFormat: "yy-mm-dd"

 });


        
    </script>
    <script type="text/javascript">


    $('#clock').click(function(argument) {
        
        $('.clockpicker').datepicker({
            placement: 'top',
            align: 'left',
            donetext: 'Done'
        });
    })

</script>
    <script type="text/javascript">
        
       var total = 0
       var theArray = {}
       var theArrayIndex = 1       
       var prevTotal = 0;
       var compArray = {};

       var theIARNum = '{{pageData1.0.0}}';


       var insOffID = ''
       var receiveoffID = ''
        
     

        $('#chck').click(function() {
            $('#butn').removeAttr('style')
            
            if ($('#chck').is(":checked")) {
                    
                    
                    var th = '<tr>'
                        th+= '<th>Decription</th>'
                        th+= '<th class="text-center">Quantity</th>'
                        th+= '<th class="text-center">Complete?</th>'
                        th+= '<th class="text-center">Actions</th>'
                        th+= '</tr>'

                    $("#tablehead").html(th);
                    $('#butn').show();
                    $('#table').html('');

            } else {

                    var th = '<tr>'
                        th+= '<th>Decription</th>'
                        th+= '<th class="text-center">Quantity</th>'
                        th+= '<th class="text-center">Complete?</th>'
                        th+= '</tr>'
                    
                    $("#tablehead").html(th);
                    $('#butn').hide()
                    $('#table').html('');
            }
        });

        $('#butn').click(function () {

            $('#newReg').modal('toggle');
        });


      
        

    $('#insofficer').keyup(function(e){
        e.preventDefault();
           
            $.ajax({
                type: 'POST',
                url:'/procurement_office/getEmployeeData/',
                data:{
                    
                    'inputName': document.getElementById("insofficer").value,
                     csrfmiddlewaretoken:$('input[name=csrfmiddlewaretoken]').val(),
                   
                },

                    success: function(response) {

                        document.getElementById("insOffList").innerHTML = ""
                        
                        for(var key in response) {
                           
                            var value = response[key];
                            document.getElementById("insOffList").innerHTML += '<option id="'+key+'" value ="'+value['name']+'"/>'

                        }

                    }

            });
    });


      $('#myTable').on('click','button', function (e) {

            
            var id = this.id;
            var value = document.getElementById(id).value

            var tdClicked = $(this).closest('td').attr('id');
            
            if (tdClicked === 'compTD') {


                if (id === value+'_comp') {


                    $('#'+value+'_comp').attr('class', 'btn btn-sm btn-success btn-circle')
                    $('#'+value+'_notcomp').attr('class', 'btn btn-sm btn-circle')

                    compArray[value] = 'TRUE'
                
                } else {
                    

                    $('#'+value+'_theDropDown').show();

                    //$('#'+value+'_notcomp').attr('class', 'btn btn-sm btn-danger btn-circle')
                    //$('#'+value+'_comp').attr('class', 'btn btn-sm btn-circle')

                    //showInputDialog('How many are missing?')
                    
                   /* $('#jOptionSave').click(function () {
                        floatInputData = $('#inputField').val();
                        
                           $('div.dropdown-content *').click(function(e){
                                e.stopPropagation(); 
                            });
                        
                        compArray[value] = {'status':'FALSE', 'quantity': parseInt(floatInputData)}

                    });*/

                }

                console.log(compArray)

            }



            if (tdClicked === 'actionTD') {

                if (id === value+'_removeRow') {
                    
                    $(this).closest ('tr').remove ();

                    delete theArray[value];

                } else {

                    
                    var theArrayData = theArray[value]
                    prevTotal = theArrayData['3']*theArrayData['4'];

                    document.getElementById("descrip2").value = theArrayData['1'];
                    document.getElementById("unit2").value = theArrayData['2'];
                    document.getElementById("price2").value = theArrayData['3'];
                    document.getElementById("quantity2").value = theArrayData['4'];
                    
                    $('#addList2').val(value);
                
                }

            }

            

        });   
        
    
        function showInputDialog(input) {
                

            $('#joptionTitle').html(input);
            $('#jOption').modal('toggle');

        }
      



    $("#insofficer").on('input', function () {
       
        var val = this.value;
        var id = $('#insOffList option[value="' + val +'"]').attr('id');
        
        insOffID = id

      }); 

    $('#receiveoff').keyup(function(e){
        e.preventDefault();
           
            $.ajax({
                type: 'POST',
                url:'/procurement_office/getEmployeeData/',
                data:{
                    
                    'inputName': document.getElementById("receiveoff").value,
                     csrfmiddlewaretoken:$('input[name=csrfmiddlewaretoken]').val(),
                   
                },

                    success: function(response) {

                        document.getElementById("recOffList").innerHTML = ""
                        
                        for(var key in response) {
                           
                            var value = response[key];
                            document.getElementById("recOffList").innerHTML += '<option id="'+key+'" value ="'+value['name']+'"/>'

                        }

                    }

            });
    });


    $("#receiveoff").on('input', function () {
       
        var val = this.value;
        var id = $('#recOffList option[value="' + val +'"]').attr('id');
        
        receiveoffID = id

      }); 

       
    // =====================================================================================================  
       
       $('#addList2').click(function() {

        var btnValue = $('#addList2').val()

        var descrip = document.getElementById("descrip2").value;
        var unit = document.getElementById("unit2").value;
        var price = document.getElementById("price2").value;
        var quantity = document.getElementById("quantity2").value;
        var itemTotal = document.getElementById("price2").value * document.getElementById("quantity2").value;
        var itemTotalToString = "" + itemTotal;
        
        var tr = '<tr id = "'+btnValue+'_tr">';
                     tr += '<td>'+descrip+'</td>';
                     tr += '<td class="text-center">'+comaSegregator(quantity)+'</td>';
                     tr += '<td class="text-center" id="compTD">';
                     tr += '<button id = "'+btnValue+'_comp" value="'+btnValue+'" class="btn btn-sm btn-success btn-circle" role= "button" aria-disabled="true" style="font-weight:200">Yes</button>';
                     tr += ' <button id = "'+btnValue+'_notcomp" value="'+btnValue+'" class="btn btn-sm btn-danger btn-circle" role= "submit" aria-disabled="true" style="font-weight:200">No</button>';
                     tr +='</td>';
                     tr += '<td class="text-center" id="workTD">';
                     tr += '<button id = "'+btnValue+'_work" value="'+btnValue+'" class="btn btn-sm btn-success btn-circle" role= "button" aria-disabled="true" style="font-weight:200">Yes</button>';
                     tr += ' <button id = "'+btnValue+'_notwork" value="'+btnValue+'" class="btn btn-sm btn-danger btn-circle" role= "submit" aria-disabled="true" style="font-weight:200">No</button>';
                     tr +='</td>';
                     tr += '<td class="text-center" id="actionTD">';
                     tr += '<button id = "'+btnValue+'_editRow" value="'+btnValue+'" data-toggle="modal"  data-target="#editReg" class="btn btn-sm btn-success btn-circle" role= "button" aria-disabled="true"><i class="icon-edit"></i></button>';
                     tr += ' <button id = "'+btnValue+'_removeRow" value="'+btnValue+'" class="btn btn-sm btn-danger btn-circle" role= "submit" aria-disabled="true"><i class="icon-remove"></i></button>';
                     tr +='</td>';
        
        total = total - prevTotal;
        total = total + itemTotal;
        var totalToString = ""+total;
        
        document.getElementById(btnValue+"_tr").innerHTML = tr;  
        
        theArray[btnValue] = {'1':descrip, '2':unit, '3':price, '4':quantity};
                      
        $('#editReg').modal('toggle');    
           
       });

// =====================================================================================================  

    $('#ponum_field').keyup(function() {
        
           if (document.getElementById("ponum_field").value.length == 6) {


                $.ajax({
                    type: 'POST',
                    url:'/inventory_office/getPOItems/',
                    data:{
                    
                        'poNum': $('#ponum_field').val(),
                        csrfmiddlewaretoken:$('input[name=csrfmiddlewaretoken]').val(),
                   
                    },

                    success: function(response) {

                        document.getElementById("table").innerHTML = "";
                        
                        for(var key in response) {
                            var value = response[key];
                            
                            var t = '';
                                var tr = '<tr id="'+value['itemnum']+'_tr">';
                                    tr += '<td>'+value['decrip']+'</td>';
                                    tr += '<td class="text-center">'+ comaSegregator(value['quantity'])+'</td>';
                                    tr += '<td class="text-center">'+value['unit']+'</td>';
                                    tr += '<td class="text-center">'+'â‚± '+ comaSegregator(value['price'])+'</td>';
                                    tr += '<td class="text-center" id="compTD">';
                                    tr += '<button id = "'+value['itemnum']+'_comp" value="'+value['itemnum']+'" class="btn btn-sm btn-success btn-circle" role= "button" aria-disabled="true" style="font-weight:200">Yes</button>';
                                   
                                    tr += '<div class="dropdown ">'
                                    tr += '<button id = "'+value['itemnum']+'_notcomp" value="'+value['itemnum']+'" class="btn btn-sm btn-danger btn-circle" role= "button" aria-disabled="true" style="font-weight:200" >No</button>'
                                    tr +=   '<div id="'+value['itemnum']+'_theDropDown" class="dropdown-content" style="min-width:160px;right:0;">'
                                     tr +=  '<div class="panel panel-default" style="margin:0px;">'
                                     tr +=  '<div class="panel-body">'
                                    tr +=     '<input id="'+value['itemnum']+'_notcomp_input" class="form-control" autofocus placeholder="Missing by?"/>'
                                     tr +=     '</div>'
                                    tr +=     '</div>'
                                     tr +=  '</div>'
                                    tr += '</div>'
                                
                                    tr +='</td>';
                                    tr += "</tr>";
                                    t += tr;
                        
                        document.getElementById("table").innerHTML += t;
        
                        }

                        displaySuppName($('#ponum_field').val())
                    }

            });
/*
            $.ajax({
                    type: 'POST',
                    url:'/inventory_office/getPODetails/',
                    data:{
                    
                        'poNum':  $('#ponum_field').val(),
                        csrfmiddlewaretoken:$('input[name=csrfmiddlewaretoken]').val(),
                   
                    },

                    success: function(response) {
                        
                        $('#suppNameDisplayPO').html(response['supp'])

                        }
                    
            });  */
            
            }
    })


 
$('#table').on('focusin', 'input', function(argument) {
    var id  = this.id
    var arr = id.split('_')


    $(this).keypress(function(e) {
    if(e.which == 13) {
        var inputData = this.value
        $('#'+arr[0]+'_notcomp').attr('class', 'btn btn-sm btn-danger btn-circle')
        $('#'+arr[0]+'_comp').attr('class', 'btn btn-sm btn-circle')

        compArray[arr[0]] = {'status':'FALSE', 'quantity': parseInt(inputData)}
        $('#'+arr[0]+'_theDropDown').hide();
        //$(".dropdown-content").hide();

    }
});
})


    function displaySuppName(input) {
         $.ajax({
                    type: 'POST',
                    url:'/inventory_office/getPODetails/',
                    data:{
                    
                        'poNum':  input,
                        csrfmiddlewaretoken:$('input[name=csrfmiddlewaretoken]').val(),
                   
                    },

                    success: function(response) {
                        
                        $('#suppNameDisplayPO').html(response['supp'])
                        $('#delTermDisplay').html(response['delTerm'].replace('.0', ''))
                        $('#delServedDisplay').html(response['dateServed'])

                        }
                    
            });  
    }


// =====================================================================================================  
       

      $('#sentNotif2').click(function () {
       
       $('#transComp').modal('toggle')
   
   })


    $('#sentNotif').click(function () {
       
       $('#transComp').modal('toggle')
       window.location.reload();
   
   })

// =====================================================================================================    
  

    function saveReceiveTrans(e) {

            console.log(theArray)
            console.log(compArray)
            $.ajax({
                type: 'POST',
                url:'/inventory_office/receiveItems/',
                data: {
                    
                    'theArray': JSON.stringify(theArray),
                    'compArray': JSON.stringify(compArray),
                    'invNum': invNum,
                    'recDate': recDate,
                    'insOff': insOffID,
                    'insdate': insdate,
                    'receiveoff': receiveoffID,
                    'receivedate': receivedate,
                    'poNum': poNum,
                    'iarnum': theIARNum,
                    csrfmiddlewaretoken:$('input[name=csrfmiddlewaretoken]').val(),
                   
                },

                    success: function(response) {
                        
                        window.location.href = "/inventory_office/generateIARDocument/";
                        $('#transComp2').modal('toggle')
                    }

            });
    }


// =====================================================================================================      

    $('#price').keypress(function(event){

       if(event.which != 8 && isNaN(String.fromCharCode(event.which))){
            document.getElementById("errorpr").innerHTML = "Non-number input is not allowed" 
           event.preventDefault(); //stop character from entering input
       }
       else{
        document.getElementById("errorpr").innerHTML = ""
        $('#price').removeAttr("style") 
       }

   });

// =====================================================================================================      

   $('#quantity').keypress(function(event){

       if(event.which != 8 && isNaN(String.fromCharCode(event.which))){
            document.getElementById("errorqu").innerHTML = "Non-number input is not allowed" 
           event.preventDefault(); //stop character from entering input
       }
       else{
        document.getElementById("errorqu").innerHTML = "" 
       }

   });


// =====================================================================================================      

    </script>

    <script type="text/javascript">

    var uiDisplay1 = '';
    var uiDisplay2 = '';


    var poNum = ''

    var invNum = ''
    var recDate = ''
    var insOff = ''
    var insdate = ''
    var receiveoff = ''
    var receivedate = ''
      
    $(document).ready(function () {
        
        uiDisplay1 = $('#displayDiv').html();
        uiDisplay2 = $('#detailsFrame').html();

        $('#detailsFrame').html('');

    });

 
    var stepCount = 0
    
    $('#nxt_btn').click(function () {

        if (stepCount === 0) {
            
            invNum = $('#receiptnum').val();
            recDate = $('#recdate').val();
            insOff = $('#insofficer').val();
            insdate = $('#insdate').val();
            receiveoff = $('#receiveoff').val();
            receivedate = $('#deldate').val();
            
            poNum = $('#ponum_field').val();
           
            console.log(poNum)
            
            //displayPageInfo();
            displayPageData();

            console.log(theArray)

            document.body.scrollTop = 0; // For Chrome, Safari and Opera 
            document.documentElement.scrollTop = 0; 

            $('#prev_btn').removeAttr('style');
            $('#displayDiv').html(uiDisplay2); 

            $('#nxt_btn').attr('class', 'btn btn-success')
            $('#nxt_btn').html('<i class="icon-plus"></i> Save Receive Transaction')


            stepCount = stepCount + 1; 

            return false;
        
        }
     
        if (stepCount === 1) {
            
            saveReceiveTrans();
        }
    
    });

    $('#prev_btn').click(function () {
         
        if (stepCount == 1) {

            $('#displayDiv').html(uiDisplay1);
            $('#receiptnum').val(invNum)
            $('#recdate').val(recDate)
            $('#insofficer').val(insOff)
            $('#insdate').val(insdate)
            $('#receiveoff').val(receiveoff)
            $('#deldate').val(receivedate)


            stepCount = stepCount - 1;
        
        }


        
        
    })


    </script>

    <script type="text/javascript">
        

    $('#deldate').focusin(function () {
        $('#deldate').datepicker({
                    format: "yyyy-mm-dd"
                }); 
    });

// =====================================================================================================      

    $('#insdate').focusin(function () {
        $('#insdate').datepicker({
                    format: "yyyy-mm-dd"
                }); 
    });

     $('#recdate').focusin(function () {
        $('#recdate').datepicker({
                    format: "yyyy-mm-dd"
                }); 
    });

     


    $('#idTourDateDetails').focusin(function () {
        $('#idTourDateDetails').datepicker({
                    format: "yyyy-mm-dd"
                }); 
    });

    $('#idTourDateDetailsHidden').focusin(function () {
        $('#idTourDateDetailsHidden').datepicker({
                    format: "yyyy-mm-dd"
                }); 
    });

// =====================================================================================================      

        $(document).ready(function () {
                

                var someDate = new Date();

                var dateToDisplay = someDate.getFullYear()+ '-' + 
                                    setSingleDigitToDouble(someDate.getMonth()+1)+ '-' + 
                                   setSingleDigitToDouble(someDate.getDate());
                 
                 
                $('#deldate').val(dateToDisplay);
                $('#insdate').val(dateToDisplay);
                $('#recdate').val(dateToDisplay);
            
            });
                
// =====================================================================================================                  
        
        function setSingleDigitToDouble(input) {
            
            
            var outputData = "" + input;
            
            
            if (outputData.length === 1) {
                outputData = "0"+input;
            }

            return outputData;

         }
// =====================================================================================================  

    </script>
    <script type="text/javascript">
        
    //========= display of the page data ============================================================== 

  
        function displayPageData() {
            

            var supplierName = '';
            var amount = '';

            //=========== table ======================================================================
                $.ajax({
                    type: 'POST',
                    url:'/inventory_office/getPOItems/',
                    data:{
                    
                        'poNum': poNum,
                        csrfmiddlewaretoken:$('input[name=csrfmiddlewaretoken]').val(),
                   
                    },

                    success: function(response) {

                        document.getElementById("receivedItemsList").innerHTML = "";
                        console.log(response)
                        for(var key in response) {
                            var value = response[key];
                            
                                var itemnumout = value['itemnum'];
                                var compQuantity = 0
                                var workQuantity = 0
                            
                            var t = '';


                                if (compArray[itemnumout] != 'TRUE') {
                                    var compArrayData = compArray[itemnumout]
                                    compQuantity = compArrayData['quantity']
                                
                                }


                                var tr = '<tr id="'+itemnumout+'_tr">';
                                    tr += '<td>'+value['decrip']+'</td>';
                                    tr += '<td class="text-center">'+(value['quantity']-compQuantity)+'</td>';
                                    tr += '<td class="text-center">'+'â‚± '+ comaSegregator(value['price'])+'</td>';
                                    tr += '<td class="text-center">'+compQuantity+'</td>';
                                    
                                    if (compQuantity === 0) {
                                        tr += '<td class="text-center" style="color:#5cb85c">Complete</td>'
                                    }else{
                                        tr += '<td class="text-center" style="color:#d9534f">Incomplete</td>'
                                    }

                                    tr += "</tr>";
                                    t += tr;
                        
                        document.getElementById("receivedItemsList").innerHTML += t;
                        
                        //theArray[value['itemnum']] = {'1':value['decrip'], '2':value['unit'], '3':value['price'], '4':value['quantity']};

                        }
                        displayPageInfo();
                    }

            });
        }

            //======================== dashboard data =============================================================
            
             function displayPageInfo(argument) {
            
                
                $.ajax({
                    type: 'POST',
                    url:'/inventory_office/getPODetails/',
                    data:{
                    
                        'poNum': poNum,
                        csrfmiddlewaretoken:$('input[name=csrfmiddlewaretoken]').val(),
                   
                    },

                    success: function(response) {
                        
                        console.log('the Details Data: '+response)
                        incQty = 0;
                        
                        
                        for (var key in compArray) {
                            
                            if (compArray[key] != 'TRUE') {
                                    var compArrayData = compArray[key]
                                    compQuantity = compArrayData['quantity']

                                    incQty = incQty + compQuantity;
                                
                                }
                        }

                        $('#suppNameDisplay').html(response['supp'])
                        //$('#totalCost').html('â‚± '+ comaSegregator(response['amount']))  
                        $('#poRefDisplay').attr('href','/inventory_office/po/'+correctURL(poNum)+'/details/')
                        $('#poRefDisplay').html(poNum) 
                        $('#recOffDis').html(receiveoff) 
                        $('#insOffDis').html(insOff) 
                        $('#invNoDisplay').html(invNum)
                        $('#iarNumDisplay').html(theIARNum);
                        $('#totalQuan').html(response['totalNumofItems'])
                        $('#dateReceivedDisplay').html(receivedate)
                        $('#dateInspectedDisplay').html(insdate)
                        $('#receiveQuan').html(response['totalNumofItems']-incQty)
                        $('#missingQuan').html(incQty)
                        if (incQty == 0) {
                          $('#itemsQuan').html('<label class="label label-success">Complete Delivery</label>')
                        } else {
                            $('#itemsQuan').html('<label class="label label-danger">Incomplete Delivery</label>')
                            
                        }

                        var dat = new Date(response['dateServed']);
                        var delDate = new Date(receivedate);
                       
                        dat.setDate(dat.getDate() + parseInt(response['delTerm']));

                        var dateToDisplay = dat.getFullYear()+ '-' + 
                                   setSingleDigitToDouble(dat.getMonth()+1)+ '-' + 
                                  setSingleDigitToDouble(dat.getDate());

                        $('#dateInspectedDisplay2').html(dateToDisplay)          
                        
                        
                        if (delDate <= dat) {
                            $('#asses').html('<label class="label label-success" id="asse">On Time</label>')
                        } else {
                             $('#asses').html('<label class="label label-danger" id="asse">Late</label>')
                        }

                        }
                        
                    
            });  

               }  
              
                


            









        // =====================================================================================================  

     function correctURL(input) {
            var arr = input.split('-')
            var output = ''
            for (var i = 0; i < arr.length; i++) {
                if (i == arr.length - 1) {
                    output = output + arr[i];
                }
                else{
                    output = output + arr[i]+'_';
                }
            }

            return output;

        }   

     function comaSegregator(input){

        var inputData = input + ''

        var output = ""
        var indexCheck = 1
        for (var i = inputData.length - 1; i >= 0; i--) {
            
            if (indexCheck%3 == 0) {

                if (i == 0) {
                     output = inputData[i] + output;
                    indexCheck = indexCheck + 1;

                } else {
                     output = ", " + inputData[i] + output;
                    indexCheck = indexCheck + 1;
                }
                   
            } else {
                output = inputData[i] + output;
                indexCheck = indexCheck + 1;
            }
        }

        return(output)
    }

       




// =====================================================================================================      

    function setErrorMsgToEmpty() {
        
        document.getElementById("errorde").innerHTML = "";
        document.getElementById("errorpr").innerHTML = "";
        document.getElementById("errorun").innerHTML = "";
        document.getElementById("errorqu").innerHTML = "";
    }



    </script>

{% endblock %}



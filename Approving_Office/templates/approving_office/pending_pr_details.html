{% extends 'approving_office/base.html' %}
{% load humanize %}

{% load staticfiles %}
{% block content %}
         <style type="text/css">
        
        .test25{
            width: 100%;
            height: 100%;
        
        }
         

        .test25 img{
             
             
             max-height: 150px;
             
         }
         .dataFont1{
            
            font-size: 15px; 
            font-weight: bold; 
            padding:7px; 
            margin-bottom:2px;
        
         }

         .dataFont2{
            
            font-weight: 450;  
            font-size: 15px;
            padding:7px; 
            margin-bottom:2px;
         }

        .dataFont3{
            
            font-size: 15px; 
            font-weight: bold; 
            padding:7px;
        
         }

         .dataFont4{
            
            font-weight: 450;  
            font-size: 15px;
            padding:7px;
         }
        

    </style>
    



        
        <!-- /. NAV SIDE  -->
        <div id="page-wrapper">

                <div style="   
                                     display:inline;
                                     float:right; 
                                     right:0; 
                                     padding-right:20px;
                                     padding-bottom: 0px;
                                     margin-top:55px; 

                                     ">

                       <form id="dlPDF" action="" method="post" style="padding:0px;">{% csrf_token %}
                                    
                                    <div class="modal-header" style="padding:0px;">
                                        <div>
                                            <button class="btn btn-success" type="button" role ="button" aria-disabled="true" id="approveButton" style="padding-right:8px; padding-left:8px; margin-right:10px;"><i class="icon-ok"></i> Approve</button>
                       <button class="btn btn-danger" role ="button" id="declineButton" aria-disabled="true" data-toggle="modal"  data-target="#newReg"><i class="icon-remove"></i> Decline</button>

                                        </div>
                                    </div>
                                    
                        </form>      

            </div>
            
            <form id="theReqData" action="" method="POST">{% csrf_token %}
            <div class="panel-body" style="
                 margin-bottom: 0px;
                 padding-left: 15px;
                 font-size: 25px;
                 padding-top: 10px;
                 padding-bottom: 0px;
                 margin-top:50px; 

                ">
                <div>
                 <span name="reqNum" id="reqNum" value="{{pageData1.0.0}}">Pending Purchase Request Details</span>
                 
                </div>
                 
               </div>
               </form>
                <div id="page-inner" style="margin-top:0px; background-color: #ddd!important;">
             
                <hr>
                <div class="col-lg-6" style="">
                         <div class="panel panel-default">
                            <div class="panel-heading">
                                <h3 class="panel-title" style="font-weight:bold;">Requisitioner Information</h3>
                            </div>
                            <div class="panel-body" style="height:150px; padding-left:20px;">
                            
                            
                            <div class="form-group">
                                <div style="padding-left: 2px;  width:100%;">
                                    <div class="col-lg-5 dataFont2">
                                        Requesting Personnel:  
                                    </div>
                                    <div class="col-lg-6 dataFont1" >
                                      {{pageData3.0.6}} {{pageData3.0.1}} {{pageData3.0.7}} {{pageData3.0.2}} {{pageData3.0.8}}
                                    </div>
                                </div> 
                            </div> 
                            <div class="form-group">
                                <div style="padding-left: 2px; width:100%;">
                                    <div class="col-lg-5 dataFont2" >
                                        Designation:  
                                    </div>
                                    <div class="col-lg-7 dataFont1">
                                      {{pageData3.0.3}}
                                    </div>
                                </div> 
                            </div>
                            
                              <div class="form-group">
                                <div style="padding-left: 2px; width:100%;">
                                    <div class="col-lg-5 dataFont2" >
                                        Department:  
                                    </div>
                                    <div class="col-lg-7 dataFont1">
                                       {{pageData3.0.4}}
                                    </div>
                                </div> 
                            </div>
                            
                           
                                
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-6"  style="padding-left:0px;">
                        <div class="panel panel-default">
                            <div class="panel-heading">
                                <h3 class="panel-title" style="font-weight:bold;">Request Information</h3>
                            </div>
                            <div class="panel-body" style="height:150px; padding-left:7px;">
                                <div class="form-group">
                                <div style="padding-left: 2px; width:100%; ">
                                    <div class="col-lg-4 dataFont2" >
                                        Date Prepared:   
                                    </div>
                                    <div class="col-lg-6 dataFont1" >
                                        {{pageData1.0.5}}
                                    </div>
                                </div> 
                            </div>
                             <div class="form-group" >
                                <div style="padding-left: 2px;  width:100%; margin-bottom:12px;">
                                    <div class="col-lg-4 dataFont2" >
                                        
                                    </div>
                                    <div class="col-lg-6 dataFont1" style="text-indent:30px;">
                                        
                                    </div>
                                </div> 
                            </div> 
                            <div class="form-group" >
                                <div style="padding-left: 2px;  width:100%; margin-bottom:12px;">
                                    <div class="col-lg-4 dataFont2" >
                                        For the purpose:  
                                    </div>
                                    <div class="col-lg-8 dataFont1" style="text-indent:0px;">
                                         {{pageData1.0.2}}
                                    </div>
                                </div> 
                            </div> 
                           
                            
                                {% if pageData7 != None %}
                                <div class="form-group">
                                <div style="padding-left: 2px; width:100%; ">
                                    <div class="col-lg-5 dataFont2" >
                                        Date of Request:   
                                    </div>
                                    <div class="col-lg-6 dataFont1" >
                                        {{pageData1.0.5}}
                                    </div>
                                </div> 
                            </div>
                            
                            <div class="form-group">
                                <div style="padding-left: 2px;  width:100%;">
                                    <div class="col-lg-5 dataFont2">
                                        Request Status:  
                                    </div>
                                    <div class="col-lg-6 dataFont1" >
                                       <label class="label label-success">Approved</label>
                                    </div>
                                </div> 
                            </div> 
                           
                              <div class="form-group">
                                <div style="padding-left: 2px; width:100%;">
                                    <div class="col-lg-5 dataFont2" >
                                        Transaction Status:  
                                    </div>
                                    <div class="col-lg-7 dataFont1">
                                        Items was Received and Accounted

                                    </div>
                                </div> 
                            </div>
                              <div class="form-group">
                                <div style="padding-left: 2px; width:100%;">
                                    <div class="col-lg-5 dataFont2" >
                                        Total Cost:  
                                    </div>
                                    <div class="col-lg-7 dataFont1">
                                      ₱ 000,000
                                    </div>
                                </div> 
                            </div>

                            <div class="form-group">
                                <div style="padding-left: 2px; width:100%;">
                                    <div class="col-lg-5 dataFont2" >
                                        Request Created Status:  
                                    </div>
                                    <div class="col-lg-7 dataFont1">
                                        5 this month, 12 this quarter
                                    </div>
                                </div> 
                            </div>
                            <div class="form-group">
                                <div style="padding-left: 2px; width:100%;">
                                    <div class="col-lg-5 dataFont2" >
                                        Approved Request Status:  
                                    </div>
                                    <div class="col-lg-7 dataFont1">
                                        3 this month, 9 this quarter
                                    </div>
                                </div> 
                            </div>
                                {% endif %}
                                
                            
                           
                      
                            

                            </div>
                        </div>
                    </div>
                
                <div class="col-lg-12" style="display: inline;">
                    
                       

                        <!--  -->
                        
                        <div class="panel panel-default">
                            <div class="panel-heading">
                                <h3 class="panel-title" style="font-weight:bold;">Items on Request</h3>
                            </div>
                            <div class="panel-body">
                                <div class="table-responsive">
                                <table class="table table-hover">
                                    <thead>
                                        <tr>
                                            <th class="text-center" style="width:80px;">Item No.</th>
                                            <th>Description</th>
                                            <th class="text-center">Unit Cost</th>
                                            <th class="text-center">Quantity</th>
                                            <th class="text-center">Unit</th>
                                            <th class="text-center">Total</th>
                                        </tr>
                                    </thead>
                                    <tbody>

                                    {% for x in pageData2 %}
                                        <tr>
                                            <td class="text-center">{{x.1}}</td>
                                            <td>{{x.2}}</td>
                                            <td class="text-center">{{x.4|floatformat|intcomma}}</td>
                                            <td class="text-center">{{x.5|floatformat|intcomma}}</td>
                                            <td class="text-center">{{x.3}}</td>
                                            <td class="text-center">{{x.6|floatformat|intcomma}}</td>
                                            <td class="text-center">

                                           
                                        </tr>
                                        
                                        {% endfor %}
                                    </tbody>
                                </table>
                              
                            </div>
                                
                            </div>
                        </div>
                    
                    <!-- -->

                </div>

                

                 <div class="col-lg-12">
                    
                       

                        <!--  -->
                        
                        <div class="panel panel-default">
                           
                            <div class="panel-body">
                           

                   <div class="form-group">
                  <div class="header-right" style="padding-right: 40px; padding-top:10px; padding-bottom:10px;">
                                                                
                                                                <div style="display: inline; font-weight: bold;  font-size: 14px;">
                                                                    Estimated Total Cost: 
                                                                </div>
                                                                
                                                                <div class="panel panel-default" style="display: inline; font-size: 18px;  font-weight: 400; padding:10px;">
                                                                    ₱ {{pageData4.0.0|floatformat|intcomma}}
                                                                </div>
                                                            </div> 

               </div> 
                           
                        </div>
                        </div>
                            </div>   
          

                <!-- /. ROW  -->
                
                  

                <div class="panel-body"  style="padding:0px;">
                    

               </div>


                </div>  


                </div>

<!-- ===================================================   Modal ==================================================================================  -->
           
                       <div class="modal fade" id="newReg" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                            <div class="modal-dialog">
                                <form action="" method="POST">{% csrf_token %} 
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                                            <h4 class="modal-title" id="H4"> Enter reason of denial</h4>
                                    </div>
                                   
                                    
                                    <div class="modal-body">

                                            <div class="checkbox" >
                                                        <label>
                                                            <div class="checker hover"><span><input checked id="chck1" class="uniform" type="checkbox" value="option1"></span></div>Select a Reason
                                                        </label>
                                             </div>
                                             
                                             <div>
                                                <select id="selReason" class="form-control">
                                                <option>On tight budget</option>
                                                <option>Unreasonable request</option>
                                                <option>Date interval of last the account is too near</option>
                                            </select>

                                             </div>
                                             

                                             <div class="checkbox">
                                                        <label>
                                                            <div class="checker hover"><span><input id="chck2" class="uniform" type="checkbox" value="option2"></span></div>Specify Reason
                                                        </label>
                                             </div>
                                                    
                                                    <div>
                                                        <textarea id="reasonIn" class="form-control" style="overflow: hidden; word-wrap: break-word; resize: horizontal; height: 100px;" disabled></textarea>
                                                    </div>
                                                
                                      
                                    </div>
                                   
                                      
                                          <div class="modal-footer">
                                            <button id="submitDecline" data-dismiss="modal" type="button" role="button" class="btn btn-success">Submit</button>
                                    </div>

                                        
                                       
                                     
                                     
                                    
                                </div>
                                </form>
                            </div>
                        </div>

<!-- ===================================================   Modal ==================================================================================  -->
<!-- ===================================================   Modal ==================================================================================  -->
           
                       <div class="modal fade" id="transCompAppr" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                            <div class="modal-dialog ">
                                <div class="modal-content ">
                                   
                                    
                                    <div class="modal-body ">

                                        <div class="media" role="submit" name="notif1" id="notif1" value="GGWP">
                                    
                                            <span class="pull-left" >
                                                <div class="btn btn-success btn-lg btn-circle" role="button" aria-disabled="true" disabled = "disabled">
                                                    <i class="icon-ok"></i></div>
                                    </span>  
                                    <div class="media-body">
                                        <h5 class="media-heading" style="margin-top:10px;">
                                            <strong>Update on Purchase Request Approval Status Complete</strong>
                                        </h5>
                                        <hr>
                                        
                                        <p style="margin-bottom:10px;">• You have successfully approved this request.</p>
                                        <p style="margin-bottom:10px;">• The personnel or office responsible on task/s for the next part of the this transaction have been notified to proceed.</p>
                                        <p style="margin-bottom:10px;">• You will be receiving notifications regarding on the developement of this transaction.</p>
                                           
                                    </div>
                                    

                                </div>
                                        
                                    </div>
                                        
                                    <div class="modal-footer">
                                            <button id="sentNotif" data-dismiss="modal" type="submit" class="btn btn-info">OK</button>
                                    </div>
                                </div>
                            </div>
                        </div>

<!-- ===================================================   Modal ==================================================================================  -->
<!-- ===================================================   Modal ==================================================================================  -->
           
                       <div class="modal fade" id="transCompDecl" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                            <div class="modal-dialog ">
                                <div class="modal-content ">
                                   
                                    
                                    <div class="modal-body ">

                                        <div class="media" role="submit" name="notif1" id="notif1" value="GGWP">
                                    
                                            <span class="pull-left" >
                                                <div class="btn btn-danger btn-lg btn-circle" role="button" aria-disabled="true" disabled = "disabled">
                                                    <i class="icon-ok"></i></div>
                                    </span>  
                                    <div class="media-body">
                                        <h5 class="media-heading" style="margin-top:10px;">
                                            <strong>Update on Purchase Request Approval Status Complete</strong>
                                        </h5>
                                        <hr>
                                        
                                        <p style="margin-bottom:10px;">• You have purposely declined this request.</p>
                                        <p style="margin-bottom:10px;">• The requesting personnel of this request will be notified regarding the denial of this request together with the it's reason.</p> 
                                    </div>
                                    

                                </div>
                                        
                                    </div>
                                        
                                    <div class="modal-footer">
                                            <button id="sentNotifDecl" data-dismiss="modal" type="submit" class="btn btn-info">OK</button>
                                    </div>
                                </div>
                            </div>
                        </div>

<!-- ===================================================   Modal ==================================================================================  -->
<!-- ===================================================   Modal ==================================================================================  -->
           
                       <div class="modal fade" id="transCompApprConf" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                            <div class="modal-dialog ">
                                <div class="modal-content ">
                                   
                                    
                                    <div class="modal-body ">

                                        <div class="media" role="submit" name="notif1" id="notif1" value="GGWP">
                                    
                                            <span class="pull-left" >
                                                <div class="btn btn-danger btn-lg btn-circle" role="button" aria-disabled="true" disabled = "disabled">
                                                    <i class="icon-exclamation"></i></div>
                                    </span>  
                                    <div class="media-body">
                                        <h5 class="media-heading" style="margin-top:10px;">
                                            <strong>Confirm Request Approval</strong>
                                        </h5>
                                        <hr>
                                        
                                        <p style="margin-bottom:10px;">Are you sure you want to approve this request?</p>
                                    </div>
                                    

                                </div>
                                        
                                    </div>
                                    <div class="modal-footer">
                                            <button id="apprReqBtn" data-dismiss="modal" type="submit" class="btn btn-success"><i class="icon-ok"></i> Yes</button>
                                            <button data-dismiss="modal" type="submit" class="btn btn-danger"><i class="icon-remove"></i> No</button>
                                    </div>
                                </div>
                            </div>
                        </div>

<!-- ===================================================   Modal ==================================================================================  -->

            </div>
            <!-- /. PAGE INNER  -->
        </div>
        <!-- /. PAGE WRAPPER  -->
    </div>
    <!-- /. WRAPPER  -->
    <div id="footer-sec">
        &copy; Mindanao State University - General Santos City
    </div>
    <!-- /. FOOTER  -->
    <!-- SCRIPTS -AT THE BOTOM TO REDUCE THE LOAD TIME-->
    <!-- JQUERY SCRIPTS -->
    
    <script src="{% static 'assets/js/jquery-1.10.2.js' %}"></script>
    <!-- BOOTSTRAP SCRIPTS -->
    <script src="{% static 'assets/js/bootstrap.js' %}"></script>
    <!-- METISMENU SCRIPTS -->
    <script src="{% static 'assets/js/jquery.metisMenu.js' %}"></script>

    <script src="{% static 'assets/plugins/bootstrap/js/bootstrap.min.js' %}"></script>
    <!-- CUSTOM SCRIPTS -->
    <script src="{% static 'assets/js/custom.js' %}"></script>
    <script type="text/javascript">
        
        $(document).ready(function () {
           $('#pr').attr('class', 'active-menu-approv');  
        })

    </script>
    
    <script type="text/javascript">
            
            var decision = '';
            var reasonRef = 'select';
            var reason = '';


    $('#submitDecline').on('click', function (e) {
            if (reasonRef === 'select') {
                reason = $('#selReason').val();
            }else{
                reason = $('#reasonIn').val();
            }
            $.ajax({
                type: 'POST',
                url:'/approving_officer/declinePR/',
                data:{
                    
                    'reason': reason,
                    csrfmiddlewaretoken:$('input[name=csrfmiddlewaretoken]').val(),

                },

                    success:function() {

                        $('#transCompDecl').modal('toggle');
                    }

            });

    });

    $('#approveButton').click(function (e) {
        $('#transCompApprConf').modal('toggle');
    })
    $('#sentNotif').click(function (e) {
        window.location.href = "/approving_officer/all_request/";
    })
      $('#sentNotifDecl').click(function (e) {
        window.location.href = "/approving_officer/all_request/";
    })



    $('#apprReqBtn').click(function (e) {
        e.preventDefault();
            $.ajax({
                type: 'POST',
                url:'/approving_officer/decidePR/',
                data:{
                    
                    'decision': 'approve',
                    csrfmiddlewaretoken:$('input[name=csrfmiddlewaretoken]').val(),

                },

                    success:function() {

                        $('#transCompAppr').modal('toggle');

                    }

            });
    })
    

    $('#chck1').click(function(e) {
        reasonRef = 'select';
       $('#chck2').removeAttr('checked')
       $('#reasonIn').attr('disabled', '')
       $('#selReason').removeAttr('disabled')
    });

    $('#chck2').click(function(e) {
        reasonRef = 'define';
       $('#chck1').removeAttr('checked')
       $('#selReason').attr('disabled', '')
       $('#reasonIn').removeAttr('disabled')
    });
            

    </script>


{% endblock %}

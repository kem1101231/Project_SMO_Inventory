{% extends 'super_user/base.html' %}
{% load humanize %}
{% load staticfiles %}
{% block content %}

<style type="text/css">
    
            .tablescroll{
            overflow-y:scroll;
            height:1033px;
            display:block;
        }
        
        .tablescroll2{
            
            overflow-y:scroll;
            height:235px;
            display:block;
        }
        .divScroll{
            
            overflow-y:scroll;
            height:450px;
            display:block;
        }

</style>
         <div id="page-wrapper">


            <!--  ========================================================   -->

          <div style="   
                                     display:inline;
                                     float:right; 
                                     right:0; 
                                     padding-right:20px;
                                     padding-bottom: 0px;
                                     margin-top:55px;
                                     display: none 
                                     ">

                                    
                                    <div class="modal-header" style="padding:0px; border-radius: 20px;">
                                        <div>
                                            <button id="sentNotif" name="reqNumB" value="{{pageData1.0.0}}" type="submit" role="submit" class="btn btn-success" style="width: 120px; border-radius: 20px; outline:none;"><i class="icon-plus"></i> Add Office</button>
                                        </div>
                                    </div>
                        
            </div>

            <form id="theReqData" action="" method="POST">{% csrf_token %}
            <div class="panel-body"  style="
                 margin-bottom: 0px;
                 padding-left: 15px;
                 font-size: 30px;
                 padding-top: 10px;
                 padding-bottom: 15px;
                 margin-top:75px; 
                 margin-bottom: 20px;

                ">
                <div>
                    
                     <p>Employee Details</p> 
                     <p style="font-size: 13px; margin-top: 20px; "><a href="/system_admin/employees/">Employees</a> / Details</p>
                </div>
                 
               </div>
               </form>



            <div id="page-inner" style="margin-top:0px; background-color: #fff!important;">
             
                <div class="col-lg-5" style="padding:8px; padding-top: 0px; ">
                    <div class="panel panel-primary" style="border-radius: 0px;">
                        
                          <div class="panel-body" style=" padding-left:10px; padding-bottom: 20px;">
                                      
                                                            
                                        <div class="panel col-lg-12 text-center" style="padding:0px; border: 1px solid #fff">
                                            <div class = "panel panel-info item-img-div"  style="margin-bottom:0px; max-width: 100%; width: 100%; border: 1px solid #fff; padding-top:25px">
                                                <img style="width: 170px; height: 170px;" src = "{% static 'assets/img/Msu.png' %}">          
                                            </div>
                                        </div>
                                        
                                        <div class="col-lg-12 text-center" style="padding-left:0px;padding-right: 0px; border-bottom: 1px solid #444; padding-bottom: 10px;font-size: 19px; padding-top: 20px; font-weight: bold;">Dr. Thenameoftheper S onnelwhichistoolong Ph.D
                                         </div>
                                    
                                           
                                        </div>
                             
                         </div>   
                    </div>
                <div class="col-lg-7" style="padding:8px; padding-top: 0px;">
                    <div class="panel panel-primary" style="border-radius: 0px;">
                        <div class="panel-body" style="border-top:4px solid #428bca; font-size: 18px; padding-top: 20px;">
                                <p>Users under this office</p>
                                <p style="margin: 0px; margin-top: 5px;  border-bottom:2px solid #428bca; width: 60%;"></p>
                            </div>
                             <div class="panel-body" style="margin:0px; padding:8px;">
                                <div class="table-responsive">
                                <table class="table table-hover" id="theOffTable">
                                    <thead>
                                        <tr style="background-color: #eee;">
                                            <th>Officer Name</th>
                                            <th class="text-center" style="width:100px;">Status</th>
                                            <th class="text-center" style="width:100px;">Actions</th>
                                            
                                        </tr>
                                    </thead>
                                    <tbody id="theTableList">
                                    {% for x in pageData2 %}
                                    <tr><td colspan="3" style="display: none">{{x}}</td></tr>
                                    <tr id="{{x.0.0}}" class="tr_class">
                                            <td>{{x.0.6}} {{x.0.1}} {{x.0.7}} {{x.0.2}} {{x.0.8}}</td>
                                            <td class="text-center" style=" background-color: 
                                                {% if x.1.5 == True %}
                                                    #5cb85c
                                                {% else %}
                                                    #d9534f
                                                {% endif %}

                                            ">
                                                {% if x.1.5 == True %}
                                                    Active
                                                {% else %}
                                                    Blocked
                                                {% endif %}
                                            </td>
                                            <td class="text-center">
                                                <button value="{{x.0.0}}" id="remBTN" class=" btn btn-sm btn-danger" style="border-radius: 15px;"><i class="icon-remove"></i></button>
                                            </td>
                                        </tr>
                                      

                                    {% endfor %}
                                        
                                       
                                    </tbody>
                                </table>
                            </div>


                            </div>
                    </div>
                </div>
                <!-- /. ROW  -->

                <div class="panel-body"  style="padding:0px;">
                   
               </div>


                </div>    

                



               <!--  ========================================================   -->



                    </div>    

        <!-- ========================================================================================================== -->

<!-- ===================================================   Modal ==================================================================================  -->
           
                       <div class="modal fade" id="updateModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                            <div class="modal-dialog">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                                            <h4 class="modal-title" id="H4"> Update the Head Personnel</h4>
                                    </div>
                                    
                                    <div class="modal-body">
                                        <div class="panel panel-body" style="padding-top:0px; margin:0px;">
                                            <form class="form-horizontal">

                                                <div id="descripDiv" class="form-group">
                                                        <label for="text1" class="control-label col-lg-4">Name of Personnel: </label>
                                                         <div class="col-lg-8">
                                                        <input id="receiveoff" class="form-control" list="recOffList" />
                                                        <datalist id="recOffList">
                                                        </datalist>
                                                        <span id="errorun"></span>
                                                    </div>
                                                    
                                                </div>
                                        
                                            </form>
                                        </div>
                                    </div>
                                        
                                    <div class="modal-footer">
                                            <button id="addList2" type="submit" class="btn btn-success" >Update Information</button>
                                    </div>
                                </div>
                            </div>
                        </div>

<!-- ===================================================   Modal ==================================================================================  -->


                    </div>
            
            </div>
            <!-- /. PAGE INNER  -->
        </div>
        <!-- /. PAGE WRAPPER  -->
    </div>
  
         
            <!-- /. PAGE INNER  -->
        </div>
        <!-- /. PAGE WRAPPER  -->
    </div>
    <!-- /. WRAPPER  -->
   
    <div id="footer-sec">
       &copy; Mindanao State University <i class=" buttom-header-right">Equipement Inventory </i>  
    </div>

    <!-- /. FOOTER  -->
    <!-- SCRIPTS -AT THE BOTOM TO REDUCE THE LOAD TIME-->
    <!-- JQUERY SCRIPTS -->
    <script src="{% static 'inventory_office/assets/js/jquery-1.10.2.js' %}"></script>
    <!-- BOOTSTRAP SCRIPTS -->
    <script src="{% static 'inventory_office/assets/js/bootstrap.js' %}"></script>
    <!-- METISMENU SCRIPTS -->
    <script src="{% static 'inventory_office/assets/js/jquery.metisMenu.js' %}"></script>
    <!-- CUSTOM SCRIPTS -->
    <script src="{% static 'inventory_office/assets/js/custom.js' %}"></script>

    <script type="text/javascript">

    var receiveoffID = '';        

    $(document).ready(function(){
        displayRISList();
    
    });

    $('#upHeadBTN').click(function() {
            $('#updateModal').modal('toggle')
    })

    $('#theTableList').on('click', 'button', function() {
        var value = this.value
         $.ajax({
            type: 'POST',
            url:'/system_admin/updateUserStatus/',
            data:{
                
                'idnum':value,   
                csrfmiddlewaretoken:$('input[name=csrfmiddlewaretoken]').val(),
                   
            },

                success: function(response) {

                       alert("Done")
                }

            }); 
    })


     $('#receiveoff').keyup(function(e){
        e.preventDefault();
           
            $.ajax({
                type: 'POST',
                url:'/procurement_office/getEmployeeData/',
                data:{
                    
                    'inputName': document.getElementById("receiveoff").value,
                     csrfmiddlewaretoken:$('input[name=csrfmiddlewaretoken]').val(),
                   
                },

                    success: function(response) {

                        document.getElementById("recOffList").innerHTML = ""
                        
                        for(var key in response) {
                           
                            var value = response[key];
                            document.getElementById("recOffList").innerHTML += '<option id="'+key+'" value ="'+value['name']+'"/>'

                        }

                    }

            });
    });


    $("#receiveoff").on('input', function () {
       
        var val = this.value;
        var id = $('#recOffList option[value="' + val +'"]').attr('id');
        
        receiveoffID = id

      }); 

    $('#addList2').click(function() {
           
        $.ajax({
            type: 'POST',
            url:'/system_admin/updateOfficeHead/',
            data:{
                'idnum':receiveoffID,
                'offid':$('#idHold').attr('value'),    
                csrfmiddlewaretoken:$('input[name=csrfmiddlewaretoken]').val(),
                   
            },

                success: function(response) {

                       alert("Done")
                }

            }); 

    })

        function displayRISList() {
            
       
                $.ajax({
                    type: 'POST',
                    url:'/inventory_office/getRIS/',
                    data:{
                    
                        csrfmiddlewaretoken:$('input[name=csrfmiddlewaretoken]').val(),
                   
                    },

                    success: function(response) {

                        document.getElementById("theRISListTable").innerHTML = "";
                        
                        var t = ''    
                            for(var key in response) {
                                var value = response[key];
                                var tr = '<tr>'
                                    if (value['risNum'] === null ) {
                                        tr+=   '<td class="text-center" >---</td>'
                                    }else{
                                        tr+=   '<td class="text-center" style="background-color: #eff3eb;">'+value['risNum']+'</td>'
                                    }
                                    
                                    tr+=  '<td>'+value['reqOff']+'</td>'
                                    if (value['status'] === true) {
                                        tr+=  '<td class="text-center"><label class="label label-success">Approved</label></td>'
                                    }
                                    if (value['status'] === null) {
                                        tr+=  '<td class="text-center"><label class="label label-warning">Pending</label></td>'
                                    }

                                    if (value['status'] === false) {
                                        tr+=  '<td class="text-center"><label class="label label-danger">Denied</label></td>'
                                    }
                                    if (value['relStatus'] === true) {
                                        tr+=  '<td class="text-center"><label class="label label-success">Released</label></td>'
                                    }
                                    if (value['relStatus'] === null && value['status'] === null) {
                                        tr+=  '<td class="text-center"><label class="label label-warning">Pending</label></td>'
                                    }
                                    if (value['relStatus'] === null && value['status'] === true) {
                                        tr+=  '<td class="text-center"><label class="label label-warning">Waiting</label></td>'
                                    }

                                    tr+=   '<td class="text-center">'
                                    tr+= '<form id="theDetails" method="POST" action="/inventory_office/displayRISDetails/">'
                                    tr+="{% csrf_token %}"
                                    tr+= '<div>'
                                     tr+=  '<button id="slipNumButton" name="slipNumButton" class="btn btn-xs '
                                     tr+=  'btn-primary" type="submit" role="submit" value="'+key+'">Details <i class="icon-arrow-right"></i></button>'
                                    tr+= '</div>'
                                    tr+= '</form>'
                                  

                                     tr+= '</td>'
                                     tr+=  '</tr>'
                                 t +=tr
                        }
                    
                    document.getElementById("theRISListTable").innerHTML += t;
                    
                    }

                }); 

            }



    </script>


   <script>
        $(document).ready(function () {

           
            $('#all_emp').attr('class','active-menu-super')
            $('#userTop').attr('class', 'active-menu-top')
            $('#userUL').attr('class','nav nav-second-level collapse in')
            $('#title').html('Users')

           
             });
    </script>

{% endblock %}


    
